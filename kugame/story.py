"""æ•…äº‹ç®¡ç†å™¨

ç®¡ç†æ­¦ä¾ æ•…äº‹çš„ç« èŠ‚ã€ä»»åŠ¡å’Œå‰§æƒ…å‘å±•ï¼Œå¢å¼ºæ•…äº‹è¶£å‘³æ€§ï¼Œä¸°å¯Œäººç‰©è®¾å®šå’Œæƒ…èŠ‚å‘å±•ã€‚
"""

from dataclasses import dataclass, field
from typing import Dict, List, Optional, Any
from enum import Enum
import random
from .player import Player, CultivationLevel


class Chapter(Enum):
    """æ•…äº‹ç« èŠ‚æšä¸¾
    
    å®šä¹‰æ•…äº‹çš„å„ä¸ªç« èŠ‚ï¼Œæ¯ä¸ªç« èŠ‚å¯¹åº”ä¸åŒçš„æ•…äº‹å†…å®¹å’Œå­¦ä¹ ç›®æ ‡ã€‚
    """
    åºç«  = "prologue"       # å…¥é—¨ä»‹ç»
    ç¬¬ä¸€ç«  = "chapter_1"     # å®¹å™¨åŸºç¡€
    ç¬¬äºŒç«  = "chapter_2"     # éƒ¨ç½²ç®¡ç†
    ç¬¬ä¸‰ç«  = "chapter_3"     # æœåŠ¡å‘ç°
    ç¬¬å››ç«  = "chapter_4"     # é…ç½®ç®¡ç†
    ç¬¬äº”ç«  = "chapter_5"     # å­˜å‚¨ç®¡ç†
    ç¬¬å…­ç«  = "chapter_6"     # èµ„æºç®¡ç†
    ç¬¬ä¸ƒç«  = "chapter_7"     # æ•…éšœæ’æŸ¥
    ç¬¬å…«ç«  = "chapter_8"     # è¿›é˜¶æ“ä½œ
    ç¬¬ä¹ç«  = "chapter_9"     # ç½‘ç»œä¸å®‰å…¨
    ç»ˆç«  = "epilogue"        # é£å‡å¤§æˆ


@dataclass
class Character:
    """æ•…äº‹äººç‰©æ•°æ®ç±»
    
    å­˜å‚¨æ•…äº‹ä¸­çš„äººç‰©ä¿¡æ¯ï¼ŒåŒ…æ‹¬å§“åã€èº«ä»½ã€æ€§æ ¼ç‰¹ç‚¹ç­‰ã€‚
    
    Attributes:
        name: äººç‰©å§“å
        identity: äººç‰©èº«ä»½
        personality: äººç‰©æ€§æ ¼
        dialogue_style: å¯¹è¯é£æ ¼
        relationship: ä¸ç©å®¶çš„å…³ç³»
    """
    name: str
    identity: str
    personality: str
    dialogue_style: str
    relationship: str


@dataclass
class Monster:
    """æ€ªç‰©æ•°æ®ç±»
    
    å­˜å‚¨æ¸¸æˆä¸­çš„æ€ªç‰©ä¿¡æ¯ã€‚
    
    Attributes:
        name: æ€ªç‰©åç§°
        health: ç”Ÿå‘½å€¼
        attack: æ”»å‡»åŠ›
        defense: é˜²å¾¡åŠ›
        experience_reward: å‡»è´¥è·å¾—çš„ç»éªŒå€¼
        command_challenge: å…³è”çš„å‘½ä»¤æŒ‘æˆ˜
        description: æ€ªç‰©æè¿°
        level: æ€ªç‰©ç­‰çº§
    """
    name: str
    health: int
    attack: int
    defense: int
    experience_reward: int
    command_challenge: Any
    description: str = ""
    level: int = 1


@dataclass
class StoryEvent:
    """æ•…äº‹äº‹ä»¶æ•°æ®ç±»
    
    å­˜å‚¨æ•…äº‹ä¸­çš„éšæœºäº‹ä»¶ä¿¡æ¯ã€‚
    
    Attributes:
        event_id: äº‹ä»¶ID
        title: äº‹ä»¶æ ‡é¢˜
        description: äº‹ä»¶æè¿°
        choices: é€‰æ‹©åˆ—è¡¨
        consequences: é€‰æ‹©åæœ
        required_level: è§¦å‘æ‰€éœ€ç­‰çº§
        rewards: å¥–åŠ±ä¿¡æ¯
        event_type: äº‹ä»¶ç±»å‹ï¼ˆnormal, combatç­‰ï¼‰
        monster: å…³è”çš„æ€ªç‰©ï¼ˆå¦‚æœæ˜¯æˆ˜æ–—äº‹ä»¶ï¼‰
    """
    event_id: str
    title: str
    description: str
    choices: List[str]
    consequences: List[str]
    required_level: int = 1
    rewards: Dict[str, Any] = field(default_factory=dict)
    event_type: str = "normal"
    monster: Optional[Monster] = None


@dataclass
class StoryChapter:
    """æ•…äº‹ç« èŠ‚æ•°æ®ç±»
    
    å­˜å‚¨æ•…äº‹ç« èŠ‚çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€ä»‹ç»ã€å™äº‹ã€æ¦‚å¿µã€å‘½ä»¤ç­‰ã€‚
    
    Attributes:
        chapter_id: ç« èŠ‚ID
        title: ç« èŠ‚æ ‡é¢˜
        introduction: ç« èŠ‚ä»‹ç»
        narrative: ç« èŠ‚å™äº‹å†…å®¹
        kubernetes_concepts: ç›¸å…³Kubernetesæ¦‚å¿µ
        commands_to_learn: æœ¬ç« èŠ‚è¦å­¦ä¹ çš„å‘½ä»¤
        challenge_id: æŒ‘æˆ˜ID
        reward_exp: å®Œæˆå¥–åŠ±ç»éªŒ
        characters: å‡ºåœºäººç‰©åˆ—è¡¨
        events: ç« èŠ‚äº‹ä»¶åˆ—è¡¨
        boss_fight: æ˜¯å¦æœ‰ boss æˆ˜
    """
    chapter_id: Chapter
    title: str
    introduction: str
    narrative: str
    kubernetes_concepts: List[str]
    commands_to_learn: List[str]
    challenge_id: str
    reward_exp: int
    characters: List[Character] = field(default_factory=list)
    events: List[StoryEvent] = field(default_factory=list)
    boss_fight: bool = False
    
    @property
    def command_count(self) -> int:
        """è·å–æœ¬ç« èŠ‚çš„å‘½ä»¤æ•°é‡"""
        return len(self.commands_to_learn)


class StoryManager:
    """æ•…äº‹ç®¡ç†å™¨
    
    ç®¡ç†æ­¦ä¾ æ•…äº‹çš„ç« èŠ‚ã€ä»»åŠ¡å’Œå‰§æƒ…å‘å±•ï¼Œæä¾›æ•…äº‹å†…å®¹ã€äº‹ä»¶ç”Ÿæˆå’Œè¿›åº¦è·Ÿè¸ªåŠŸèƒ½ã€‚
    
    Attributes:
        chapters: ç« èŠ‚å­—å…¸
        current_chapter: å½“å‰ç« èŠ‚
        characters: æ‰€æœ‰å‡ºåœºäººç‰©
        random_events: éšæœºäº‹ä»¶åˆ—è¡¨
    """
    chapters: Dict[Chapter, StoryChapter]
    current_chapter: Chapter
    characters: Dict[str, Character]
    random_events: List[StoryEvent]
    
    def __init__(self) -> None:
        self.characters = self._initialize_characters()
        self.random_events = self._initialize_random_events()
        self.chapters = self._initialize_chapters()
        self.current_chapter = Chapter.åºç« 
    
    def _initialize_characters(self) -> Dict[str, Character]:
        """åˆå§‹åŒ–æ•…äº‹äººç‰©
        
        åˆ›å»ºæ•…äº‹ä¸­æ‰€æœ‰å‡ºåœºçš„äººç‰©è§’è‰²ã€‚
        
        Returns:
            Dict[str, Character]: äººç‰©å­—å…¸
        """
        return {
            "æŒé—¨çœŸäºº": Character(
                name="é’äº‘å­",
                identity="é’äº‘å®—æŒé—¨",
                personality="æ…ˆç¥¥ç¿æ™ºï¼Œæ·±è°‹è¿œè™‘",
                dialogue_style="è¯­é‡å¿ƒé•¿ï¼Œå……æ»¡å“²ç†",
                relationship="å¸ˆçˆ¶"
            ),
            "å¤§å¸ˆå…„": Character(
                name="æé’å³°",
                identity="é’äº‘å®—å¤§å¸ˆå…„ï¼Œæ‰§æ³•å ‚é¦–åº§",
                personality="ä¸¥è‚ƒè®¤çœŸï¼Œä¸€ä¸ä¸è‹Ÿ",
                dialogue_style="ç›´æ¥æ˜äº†ï¼Œä¸¥æ ¼è¦æ±‚",
                relationship="å¸ˆå…„"
            ),
            "äºŒå¸ˆå…„": Character(
                name="ç‹æµ©å®‡",
                identity="é’äº‘å®—äºŒå¸ˆå…„ï¼Œå¤–é—¨æ‰§äº‹",
                personality="çƒ­æƒ…å¼€æœ—ï¼Œä¹äºåŠ©äºº",
                dialogue_style="äº²åˆ‡å‹å¥½ï¼Œå¾ªå¾ªå–„è¯±",
                relationship="å¸ˆå…„"
            ),
            "ä¸‰å¸ˆå§": Character(
                name="æ—é›¨è±",
                identity="é’äº‘å®—ä¸‰å¸ˆå§ï¼Œè—ç»é˜ç®¡ç†å‘˜",
                personality="æ¸©æŸ”ä½“è´´ï¼Œåšå­¦å¤šæ‰",
                dialogue_style="å¨“å¨“é“æ¥ï¼Œè¯¦ç»†è€å¿ƒ",
                relationship="å¸ˆå§"
            ),
            "å››å¸ˆå¦¹": Character(
                name="è‹çµå„¿",
                identity="é’äº‘å®—å››å¸ˆå¦¹ï¼Œç‚¼ä¸¹é˜å¼Ÿå­",
                personality="æ´»æ³¼å¯çˆ±ï¼Œå¤çµç²¾æ€ª",
                dialogue_style="ä¿çš®çµåŠ¨ï¼Œå……æ»¡æ´»åŠ›",
                relationship="å¸ˆå¦¹"
            ),
            "é­”æ•™æ•™ä¸»": Character(
                name="è¡€é­”",
                identity="ç‚¼ç‹±é—¨æ•™ä¸»",
                personality="é˜´é™©ç‹¡è¯ˆï¼Œé‡å¿ƒå‹ƒå‹ƒ",
                dialogue_style="å†·é…·æ— æƒ…ï¼Œå……æ»¡å¨èƒ",
                relationship="æ•Œäºº"
            ),
            "ç¥ç§˜äºº": Character(
                name="ç¥ç§˜äºº",
                identity="æ¥å†ä¸æ˜çš„ä¿®çœŸè€…",
                personality="ç¥ç§˜è«æµ‹ï¼Œäº¦æ­£äº¦é‚ª",
                dialogue_style="é«˜æ·±è«æµ‹ï¼Œæ„å‘³æ·±é•¿",
                relationship="ä¸­ç«‹"
            )
        }
    
    def _initialize_random_events(self) -> List[StoryEvent]:
        """åˆå§‹åŒ–éšæœºäº‹ä»¶
        
        åˆ›å»ºæ¸¸æˆä¸­å¯èƒ½è§¦å‘çš„éšæœºäº‹ä»¶ã€‚
        
        Returns:
            List[StoryEvent]: éšæœºäº‹ä»¶åˆ—è¡¨
        """
        return [
            # æ™®é€šäº‹ä»¶
            StoryEvent(
                event_id="treasure_found",
                title="å‘ç°å®è—",
                description="ä½ åœ¨å®—é—¨åå±±ä¿®ç‚¼æ—¶ï¼Œæ„å¤–å‘ç°äº†ä¸€ä¸ªéšè—çš„å®ç®±ï¼",
                choices=["æ‰“å¼€å®ç®±", "ä¸ŠæŠ¥å®—é—¨", "ç¦»å¼€æ­¤åœ°"],
                consequences=[
                    "ä½ æ‰“å¼€äº†å®ç®±ï¼Œå‘ç°äº†ä¸€æœ¬ä¿®ç‚¼ç§˜ç±ï¼è·å¾—äº†100ç»éªŒå€¼ï¼",
                    "ä½ å°†å®ç®±ä¸ŠæŠ¥å®—é—¨ï¼ŒæŒé—¨çœŸäººèµèµä½ çš„è¯šå®ï¼Œå¥–åŠ±ä½ 50ç»éªŒå€¼ï¼",
                    "ä½ å†³å®šä¸æƒ¹éº»çƒ¦ï¼Œç¦»å¼€äº†æ­¤åœ°ã€‚"
                ],
                required_level=1,
                rewards={
                    "0": {"experience": 100},
                    "1": {"experience": 50}
                }
            ),
            StoryEvent(
                event_id="disciple_quarrel",
                title="å¼Ÿå­äº‰æ‰§",
                description="ä½ é‡åˆ°ä¸¤ä¸ªå¼Ÿå­æ­£åœ¨äº‰æ‰§ï¼Œä»–ä»¬éƒ½è®¤ä¸ºè‡ªå·±çš„Kuberneteså‘½ä»¤æ˜¯æ­£ç¡®çš„ã€‚",
                choices=["è°ƒè§£äº‰æ‰§", "æ”¯æŒå¤§å¸ˆå…„æ´¾", "æ”¯æŒäºŒå¸ˆå…„æ´¾"],
                consequences=[
                    "ä½ æˆåŠŸè°ƒè§£äº†äº‰æ‰§ï¼Œä¸¤äººéƒ½å‘ä½ é“è°¢ã€‚è·å¾—äº†80ç»éªŒå€¼ï¼",
                    "ä½ æ”¯æŒäº†å¤§å¸ˆå…„æ´¾ï¼Œå¤§å¸ˆå…„å¯¹ä½ å¥½æ„Ÿåº¦æå‡ã€‚è·å¾—äº†50ç»éªŒå€¼ï¼",
                    "ä½ æ”¯æŒäº†äºŒå¸ˆå…„æ´¾ï¼ŒäºŒå¸ˆå…„å¯¹ä½ å¥½æ„Ÿåº¦æå‡ã€‚è·å¾—äº†50ç»éªŒå€¼ï¼"
                ],
                required_level=3,
                rewards={
                    "0": {"experience": 80},
                    "1": {"experience": 50},
                    "2": {"experience": 50}
                }
            ),
            StoryEvent(
                event_id="mysterious_visitor",
                title="ç¥ç§˜è®¿å®¢",
                description="ä¸€ä½ç¥ç§˜è®¿å®¢æ¥åˆ°å®—é—¨ï¼Œæƒ³è¦æŒ‘æˆ˜ä½ çš„KubernetesçŸ¥è¯†ï¼",
                choices=["æ¥å—æŒ‘æˆ˜", "æ‹’ç»æŒ‘æˆ˜", "è¯·æ•™è®¿å®¢"],
                consequences=[
                    "ä½ æ¥å—äº†æŒ‘æˆ˜ï¼ŒæˆåŠŸå‡»è´¥äº†è®¿å®¢ï¼è·å¾—äº†150ç»éªŒå€¼ï¼",
                    "ä½ æ‹’ç»äº†æŒ‘æˆ˜ï¼Œè®¿å®¢å¤±æœ›åœ°ç¦»å¼€äº†ã€‚",
                    "ä½ å‘è®¿å®¢è¯·æ•™ï¼Œå­¦åˆ°äº†ä¸å°‘æ–°çŸ¥è¯†ã€‚è·å¾—äº†30ç»éªŒå€¼ï¼"
                ],
                required_level=5,
                rewards={
                    "0": {"experience": 150},
                    "2": {"experience": 30}
                }
            ),
            
            # æˆ˜æ–—äº‹ä»¶
            StoryEvent(
                event_id="monster_attack_pod",
                title="Podé­”è¢­å‡»",
                description="ä¸€åªPodé­”çªç„¶ä»è™šç©ºä¸­å‡ºç°ï¼Œå®ƒä¸æ–­åå™¬å‘¨å›´çš„èµ„æºï¼Œä½ å¿…é¡»é˜»æ­¢å®ƒï¼",
                choices=["æˆ˜æ–—", "é€ƒè·‘"],
                consequences=[
                    "ä½ ä¸Podé­”å±•å¼€äº†æ¿€çƒˆçš„æˆ˜æ–—ï¼",
                    "ä½ é€‰æ‹©äº†é€ƒè·‘ï¼ŒPodé­”åœ¨èº«åç©·è¿½ä¸èˆï¼"
                ],
                required_level=2,
                event_type="combat",
                monster=Monster(
                    name="Podé­”",
                    health=50,
                    attack=8,
                    defense=2,
                    experience_reward=100,
                    command_challenge="kubectl get pods",
                    description="ç”±å¤±æ§çš„Podè½¬åŒ–è€Œæˆçš„æ€ªç‰©ï¼Œå–œæ¬¢åå™¬èµ„æº",
                    level=2
                )
            ),
            StoryEvent(
                event_id="monster_deployment",
                title="Deploymentå·¨å…½",
                description="ä¸€åªå·¨å¤§çš„Deploymentå·¨å…½æ­£åœ¨ç ´åå®—é—¨çš„éƒ¨ç½²ï¼Œå®ƒèƒ½å¤Ÿä¸æ–­åˆ†è£‚å‡ºPodé­”ï¼",
                choices=["æˆ˜æ–—", "å¯»æ‰¾æ”¯æ´"],
                consequences=[
                    "ä½ å‹‡æ•¢åœ°ä¸Deploymentå·¨å…½å±•å¼€äº†æˆ˜æ–—ï¼",
                    "ä½ å»å¯»æ‰¾åŒé—¨æ”¯æ´ï¼Œå›æ¥æ—¶Deploymentå·¨å…½å·²ç»ç ´åäº†æ›´å¤šéƒ¨ç½²ï¼"
                ],
                required_level=5,
                event_type="combat",
                monster=Monster(
                    name="Deploymentå·¨å…½",
                    health=120,
                    attack=15,
                    defense=5,
                    experience_reward=250,
                    command_challenge="kubectl scale deployment",
                    description="ç”±å¤±æ§çš„Deploymentè½¬åŒ–è€Œæˆçš„å·¨å…½ï¼Œèƒ½å¤Ÿä¸æ–­åˆ†è£‚",
                    level=5
                )
            ),
            StoryEvent(
                event_id="monster_service",
                title="Serviceå¹½çµ",
                description="ä¸€åªServiceå¹½çµæ­£åœ¨å¹²æ‰°å®—é—¨çš„ç½‘ç»œï¼Œå¯¼è‡´æœåŠ¡æ— æ³•æ­£å¸¸é€šä¿¡ï¼",
                choices=["æˆ˜æ–—", "ä¿®å¤ç½‘ç»œ"],
                consequences=[
                    "ä½ ä¸Serviceå¹½çµå±•å¼€äº†æ¿€çƒˆçš„æˆ˜æ–—ï¼",
                    "ä½ å°è¯•ä¿®å¤ç½‘ç»œï¼Œä½†Serviceå¹½çµä¸æ–­å¹²æ‰°ä½ çš„å·¥ä½œï¼"
                ],
                required_level=8,
                event_type="combat",
                monster=Monster(
                    name="Serviceå¹½çµ",
                    health=80,
                    attack=12,
                    defense=3,
                    experience_reward=200,
                    command_challenge="kubectl get services",
                    description="ç”±æ•…éšœçš„Serviceè½¬åŒ–è€Œæˆçš„å¹½çµï¼Œå¹²æ‰°ç½‘ç»œé€šä¿¡",
                    level=8
                )
            ),
            
            # å…¶ä»–äº‹ä»¶
            StoryEvent(
                event_id="sword_dojo",
                title="å‰‘å†¢è¯•ç‚¼",
                description="ä½ æ¥åˆ°äº†å®—é—¨çš„å‰‘å†¢è¯•ç‚¼åœºï¼Œè¿™é‡Œæœ‰å„ç§Kuberneteså‘½ä»¤çš„å‰‘è°±ç­‰å¾…ä½ æŒ‘æˆ˜ï¼",
                choices=["æŒ‘æˆ˜åˆçº§å‰‘è°±", "æŒ‘æˆ˜ä¸­çº§å‰‘è°±", "æŒ‘æˆ˜é«˜çº§å‰‘è°±"],
                consequences=[
                    "ä½ è½»æ¾å®Œæˆäº†åˆçº§å‰‘è°±æŒ‘æˆ˜ï¼è·å¾—äº†50ç»éªŒå€¼ï¼",
                    "ä½ èŠ±è´¹äº†ä¸€äº›æ—¶é—´ï¼Œç»ˆäºå®Œæˆäº†ä¸­çº§å‰‘è°±æŒ‘æˆ˜ï¼è·å¾—äº†120ç»éªŒå€¼ï¼",
                    "é«˜çº§å‰‘è°±å¼‚å¸¸è‰°éš¾ï¼Œä½ å‹‰å¼ºé€šè¿‡ï¼Œè·å¾—äº†200ç»éªŒå€¼å’Œç¨€æœ‰ç§°å·ï¼"
                ],
                required_level=7,
                rewards={
                    "0": {"experience": 50},
                    "1": {"experience": 120},
                    "2": {"experience": 200, "title": "å‰‘è°±å¤§å¸ˆ"}
                }
            ),
            StoryEvent(
                event_id="crisis_at_gate",
                title="å±±é—¨å±æœº",
                description="é­”æ•™å¼Ÿå­çªç„¶è¢­å‡»å±±é—¨ï¼Œä½ éœ€è¦ç«‹å³é‡‡å–è¡ŒåŠ¨ï¼",
                choices=["æ­£é¢è¿æ•Œ", "è¿‚å›åŒ…æŠ„", "é€šçŸ¥å¸ˆå…„å¸ˆå§"],
                consequences=[
                    "ä½ æ­£é¢è¿æ•Œï¼Œè™½ç„¶å—ä¼¤ï¼Œä½†æˆåŠŸå‡»é€€äº†æ•Œäººï¼è·å¾—äº†100ç»éªŒå€¼ï¼",
                    "ä½ è¿‚å›åˆ°æ•Œäººèº«åï¼Œå‘åŠ¨çªè¢­ï¼Œè·å¾—äº†80ç»éªŒå€¼å’Œå¤§å¸ˆå…„çš„èµèµï¼",
                    "ä½ é€šçŸ¥äº†å¸ˆå…„å¸ˆå§ï¼Œå¤§å®¶ä¸€èµ·è½»æ¾å‡»é€€äº†æ•Œäººï¼è·å¾—äº†50ç»éªŒå€¼ï¼"
                ],
                required_level=9,
                rewards={
                    "0": {"experience": 100},
                    "1": {"experience": 80},
                    "2": {"experience": 50}
                }
            )
        ]
    
    def _initialize_chapters(self) -> Dict[Chapter, StoryChapter]:
        """åˆå§‹åŒ–æ‰€æœ‰ç« èŠ‚
        
        åˆ›å»ºæ•…äº‹çš„æ‰€æœ‰ç« èŠ‚ï¼ŒåŒ…æ‹¬ç« èŠ‚å†…å®¹ã€æ¦‚å¿µã€å‘½ä»¤å’Œäººç‰©ã€‚
        
        Returns:
            Dict[Chapter, StoryChapter]: ç« èŠ‚å­—å…¸
        """
        return {
            Chapter.åºç« : StoryChapter(
                chapter_id=Chapter.åºç« ,
                title="è¸å…¥ä»™é—¨",
                introduction="å‡¡äººä¹‹èº¯ï¼Œäº¦å¯é—®é“è‹ç©¹ã€‚ä½ ç«™åœ¨é’äº‘å®—å±±é—¨å‰ï¼Œå¿ƒä¸­å……æ»¡å¯¹ä¿®çœŸå¤§é“çš„å¥½å¥‡ä¸å‘å¾€ã€‚",
                narrative="""
                é’äº‘å®—ï¼Œä¹ƒä¿®çœŸç•Œç¬¬ä¸€å¤§å®—ï¼Œä»¥"é“æ³•è‡ªç„¶ï¼Œå®¹å™¨ä¹‹é“"é—»åäºä¸–ã€‚å®—é—¨å»ºåœ¨äº‘æµ·ä¹‹ä¸Šï¼Œ
                å¼Ÿå­ä»¬ä¿®ç‚¼çš„æ˜¯å°†ä¸‡ç‰©åŒ–ä¸ºå®¹å™¨çš„ç¥é€šï¼Œå¯éšå¿ƒæ‰€æ¬²åœ°æ“æ§å„ç§èµ„æºã€‚
                
                å±±é—¨å‰ï¼Œä¸€ä½ç™½å‘è‹è‹çš„è€è€…æ­£åœ¨æ¸…æ‰«è½å¶ã€‚ä»–æŠ¬å¤´çœ‹äº†ä½ ä¸€çœ¼ï¼Œçœ¼ä¸­é—ªè¿‡ä¸€ä¸ç²¾å…‰ï¼š
                "å¹´è½»äººï¼Œä½ å¯è§è¿‡é‚£äº‘ç«¯ä¹‹ä¸Šçš„ä»™å¢ƒï¼Ÿ"
                
                "å¼Ÿå­æœªæ›¾è§è¿‡ï¼Œä½†å¿ƒå‘å¾€ä¹‹ã€‚"ä½ æ­æ•¬åœ°å›ç­”ã€‚
                
                è€è€…å¾®å¾®ä¸€ç¬‘ï¼š"è¦æƒ³è¸å…¥ä»™å¢ƒï¼Œéœ€å…ˆå­¦ä¼š'å®¹å™¨åŒ–'ä¹‹æœ¯ã€‚æ­¤æœ¯å¯å°†ä¸‡ç‰©è£…å…¥æ–¹å¯¸ä¹‹é—´ï¼Œ
                éšå–éšç”¨ï¼Œæ¥å»è‡ªå¦‚ã€‚æˆ‘æ˜¯é’äº‘å®—çš„æŒé—¨é’äº‘å­ï¼Œä½ å¯æ„¿æ‹œå…¥æˆ‘é—¨ä¸‹ï¼Ÿ"
                
                ä½ æ¯«ä¸çŠ¹è±«åœ°è·ªä¸‹ï¼š"å¼Ÿå­æ„¿æ„ï¼"
                
                é’äº‘å­æ»¡æ„åœ°ç‚¹ç‚¹å¤´ï¼Œæ‰‹ä¸­æ‹‚å°˜ä¸€æŒ¥ï¼Œä¸€è¡Œé‡‘è‰²æ–‡å­—æµ®ç°ç©ºä¸­ï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    å®¹å™¨åŒ–å…¥é—¨å¿ƒæ³•                         â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl run nginx --image=nginx                        â”‚
                â”‚  ï¼ˆåˆ›å»ºåä¸ºnginxçš„å®¹å™¨ï¼Œå¦‚æ„é‡‘ç®æ£’èˆ¬éšå¿ƒæ‰€æ¬²ï¼‰             â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "æ­¤ä¹ƒ'kubectl run'å¿ƒæ³•ï¼Œå¯åˆ›å»ºä¸–é—´ä¸‡ç‰©ã€‚å»å§ï¼Œåœ¨å¿ƒä¸­é»˜å¿µæ­¤å’’ï¼Œ
                æ„Ÿå—å®¹å™¨åŒ–ä¹‹æœ¯çš„å¥‡å¦™ã€‚å¾…ä½ æŒæ¡æ­¤æœ¯ï¼Œä¾¿æ­£å¼æˆä¸ºæˆ‘é’äº‘å®—çš„å¼Ÿå­ã€‚"
                """,
                kubernetes_concepts=["å®¹å™¨åŒ–åŸºç¡€", "Podæ¦‚å¿µ", "å®¹å™¨è¿è¡Œ"],
                commands_to_learn=["kubectl run", "kubectl get pods", "kubectl describe pod"],
                challenge_id="prologue_challenge",
                reward_exp=200,
                characters=[self.characters["æŒé—¨çœŸäºº"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç¬¬ä¸€ç« : StoryChapter(
                chapter_id=Chapter.ç¬¬ä¸€ç« ,
                title="å®¹å™¨ä¹‹é“",
                introduction="åˆå…¥é’äº‘å®—ï¼Œä½ å¼€å§‹å­¦ä¹ å®¹å™¨åŒ–ä¹‹æœ¯çš„åŸºç¡€ã€‚",
                narrative="""
                ä¸‰ä¸ªæœˆåï¼Œä½ å·²ç»æŒæ¡äº†åˆ›å»ºå®¹å™¨çš„åŸºæœ¬æ–¹æ³•ã€‚è¿™ä¸€æ—¥ï¼ŒæŒé—¨çœŸäººå¬é›†ä¼—å¼Ÿå­ï¼š
                
                "è¿‘æ—¥é­”æ•™è ¢è ¢æ¬²åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹æ›´å¼ºå¤§çš„é˜²å¾¡ä½“ç³»ã€‚ä¼—å¼Ÿå­å¬ä»¤ï¼Œ
                éœ€æŒæ¡'éƒ¨ç½²'ä¹‹æœ¯ï¼Œæ–¹èƒ½å®ˆæŠ¤å®—é—¨å®‰å…¨ã€‚"
                
                äºŒå¸ˆå…„ç‹æµ©å®‡èµ°åˆ°ä½ é¢å‰ï¼Œæ‹äº†æ‹ä½ çš„è‚©è†€ï¼š
                "å°å¸ˆå¼Ÿï¼Œå®¹å™¨åªæ˜¯ä¸ªä½“ï¼Œå¦‚åŒæ•£å…µæ¸¸å‹‡ï¼›éƒ¨ç½²æ‰æ˜¯å†›é˜Ÿï¼Œèƒ½å¤ŸååŒä½œæˆ˜ã€‚
                è®©æˆ‘æ•™ä½ 'Deployment'ä¹‹é“ï¼Œè¿™æ˜¯æˆä¸ºå°†å¸…çš„åŸºç¡€ã€‚"
                
                äºŒå¸ˆå…„è¯´ç€ï¼Œæ‰‹ä¸­å‡ºç°ä¸€é¢ä»¤æ——ï¼ŒæŒ¥äº†æŒ¥ä»¤æ——ï¼Œåœ°é¢ä¸Šå‡ºç°äº†æ•´é½æ’åˆ—çš„å£«å…µï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    éƒ¨ç½²å†›é˜Ÿå¿ƒæ³•                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl create deployment web --image=nginx            â”‚
                â”‚  ï¼ˆåˆ›å»ºåä¸ºwebçš„éƒ¨ç½²å†›é˜Ÿï¼Œæ°¸ä¸é€€ç¼©ï¼‰                      â”‚
                â”‚                                                         â”‚
                â”‚  kubectl scale deployment web --replicas=3              â”‚
                â”‚  ï¼ˆæ‰©ç¼–å†›é˜Ÿè‡³ä¸‰äººï¼Œé½å¿ƒååŠ›ï¼‰                             â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "è®°ä½ï¼Œä¸€ä¸ªå¥½çš„å°†å†›ä¸ä»…è¦èƒ½åˆ›å»ºå£«å…µï¼Œæ›´è¦æ‡‚å¾—å¦‚ä½•ç®¡ç†å’Œè°ƒåº¦ä»–ä»¬ã€‚
                Deploymentå°±åƒæ˜¯ä½ çš„ä¸­å†›å¤§å¸ï¼Œé€šè¿‡å®ƒä½ å¯ä»¥æŒ‡æŒ¥åƒå†›ä¸‡é©¬ï¼"
                """,
                kubernetes_concepts=["Deployment", "ReplicaSet", "å‰¯æœ¬ç®¡ç†", "Podæ¨¡æ¿"],
                commands_to_learn=["kubectl create deployment", "kubectl scale", "kubectl get deployments", "kubectl rollout status"],
                challenge_id="chapter_1_challenge",
                reward_exp=300,
                characters=[self.characters["æŒé—¨çœŸäºº"], self.characters["äºŒå¸ˆå…„"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç¬¬äºŒç« : StoryChapter(
                chapter_id=Chapter.ç¬¬äºŒç« ,
                title="æœåŠ¡ä¹‹é—¨",
                introduction="æŒæ¡äº†éƒ¨ç½²æœ¯åï¼Œä½ éœ€è¦å­¦ä¼šå¦‚ä½•è®©æœåŠ¡å¯¹å¤–æš´éœ²ã€‚",
                narrative="""
                ä½ å·²ç»èƒ½å¤Ÿåˆ›å»ºå’Œç®¡ç†éƒ¨ç½²å†›é˜Ÿï¼Œä½†æ–°çš„é—®é¢˜éšä¹‹è€Œæ¥ã€‚
                
                è¿™ä¸€æ—¥ï¼Œå®—é—¨çªç„¶å“èµ·æ€¥ä¿ƒçš„é’Ÿå£°ï¼š"æŠ¥â€”â€”ï¼é­”æ•™æ¥è¢­ï¼" 
                
                å¤§å¸ˆå…„æé’å³°ç«‹å³ä¸‹ä»¤ï¼š"å¯åŠ¨æŠ¤å±±å¤§é˜µï¼è®©å¤–ç•Œèƒ½è®¿é—®æˆ‘ä»¬çš„æœåŠ¡ï¼
                å°å¸ˆå¼Ÿï¼Œä½ è´Ÿè´£å¼€å¯å®—é—¨çš„æœåŠ¡ä¹‹é—¨ï¼"
                
                ä½ ç–‘æƒ‘åœ°é—®ï¼š"å¦‚ä½•è®©å¤–ç•Œè®¿é—®æˆ‘ä»¬çš„æœåŠ¡ï¼Ÿ"
                
                å¤§å¸ˆå…„è§£é‡Šé“ï¼š"è¿™ä¾¿éœ€è¦'Service'ä¹‹æœ¯ã€‚Serviceæ˜¯å®¹å™¨çš„é—¨å¾’ï¼Œ
                è´Ÿè´£å°†å¤–ç•Œçš„è¯·æ±‚å¼•å¯¼è‡³æ­£ç¡®çš„Podã€‚å°±å¦‚åŒå®—é—¨çš„è¿å®¢å¼Ÿå­ï¼Œ
                å¼•å¯¼æ¥è®¿è€…å‰å¾€æ­£ç¡®çš„æ®¿å ‚ã€‚"
                
                å¤§å¸ˆå…„è¯´ç€ï¼Œæ‰‹ä¸­å‡ºç°ä¸€æ‰‡é‡‘è‰²çš„é—¨ï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    æœåŠ¡æš´éœ²å¿ƒæ³•                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl expose deployment web --port=80 --type=NodePortâ”‚
                â”‚  ï¼ˆå¼€å¯æœåŠ¡ä¹‹é—¨ï¼Œè®©å¤–ç•Œå¯è®¿ï¼‰                             â”‚
                â”‚                                                         â”‚
                â”‚  kubectl get svc                                        â”‚
                â”‚  ï¼ˆæŸ¥çœ‹æœåŠ¡ä¹‹é—¨çš„çŠ¶æ€ï¼‰                                   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "Serviceæœ‰ä¸‰ç§å½¢æ€ï¼šClusterIPï¼ˆå†…éƒ¨é€šé“ï¼‰ã€NodePortï¼ˆå¤–éƒ¨é€šé“ï¼‰
                å’ŒLoadBalancerï¼ˆå¤©åœ°ä¹‹æ¡¥ï¼‰ã€‚æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„å½¢æ€ã€‚
                ç°åœ¨ï¼Œç”¨ä½ å­¦åˆ°çš„Serviceä¹‹æœ¯ï¼Œå¼€å¯å®—é—¨çš„é˜²å¾¡å¤§é˜µï¼"
                """,
                kubernetes_concepts=["Service", "ç«¯å£æ˜ å°„", "è´Ÿè½½å‡è¡¡", "ç½‘ç»œæš´éœ²"],
                commands_to_learn=["kubectl expose", "kubectl get services", "kubectl describe service", "kubectl delete service"],
                challenge_id="chapter_2_challenge",
                reward_exp=350,
                characters=[self.characters["å¤§å¸ˆå…„"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç¬¬ä¸‰ç« : StoryChapter(
                chapter_id=Chapter.ç¬¬ä¸‰ç« ,
                title="é…ç½®ä¹‹å¯†",
                introduction="çœŸæ­£çš„å¼ºè€…æ‡‚å¾—å¦‚ä½•çµæ´»é…ç½®ï¼Œè€Œéç¡¬ç¼–ç ã€‚",
                narrative="""
                æˆ˜äº‰æ—¥ç›Šæ¿€çƒˆï¼Œä½ éœ€è¦ç®¡ç†æ›´å¤šçš„é…ç½®ä¿¡æ¯ã€‚è¿™ä¸€æ—¥ï¼ŒæŒé—¨çœŸäººå¬è§ä½ ï¼š
                
                "å¾’å„¿ï¼Œä½ å·²å­¦ä¼šåˆ›å»ºæœåŠ¡ï¼Œä½†è‹¥æ¯æ¬¡ä¿®æ”¹é…ç½®éƒ½è¦é‡æ–°åˆ›å»ºPodï¼Œ
                å²‚ä¸åŠ³æ°‘ä¼¤è´¢ï¼Ÿä»Šæ—¥æœ¬åº§ä¼ æˆä½ 'ConfigMap'å’Œ'Secret'ä¹‹æœ¯ã€‚"
                
                æŒé—¨çœŸäººè¯´ç€ï¼Œæ‰‹ä¸­å‡ºç°ä¸¤ä¸ªç¥ç§˜çš„å·è½´ï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    é…ç½®ç®¡ç†å¿ƒæ³•                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl create configmap app-config --from-literal=key1â”‚
                â”‚  =value1 --from-file=config.yaml                        â”‚
                â”‚  ï¼ˆåˆ›å»ºé…ç½®å¯†å·ï¼Œè®°å½•å¤©åœ°æ³•åˆ™ï¼‰                           â”‚
                â”‚                                                         â”‚
                â”‚  kubectl create secret generic db-secret \             â”‚
                â”‚      --from-literal=password=mypassword                 â”‚
                â”‚  ï¼ˆåˆ›å»ºæœºå¯†å¯†é’¥ï¼Œå®ˆæŠ¤é‡è¦ä¿¡æ¯ï¼‰                           â”‚
                â”‚                                                         â”‚
                â”‚  kubectl get configmaps                                 â”‚
                â”‚  ï¼ˆæŸ¥çœ‹é…ç½®å¯†å·ï¼‰                                        â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "ConfigMapå­˜å‚¨æ™®é€šé…ç½®ï¼Œå¦‚åŒå…¬å¼€çš„ä¿®ç‚¼å¿ƒæ³•ï¼›
                SecretåŠ å¯†å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚åŒå®—é—¨çš„ä¸ä¼ ä¹‹ç§˜ã€‚
                å–„ç”¨æ­¤æœ¯ï¼Œå¯ä½¿ä½ çš„åº”ç”¨å¦‚è‡‚ä½¿æŒ‡ï¼Œçµæ´»å¤šå˜ã€‚
                ç°åœ¨ï¼Œç”¨ä½ å­¦åˆ°çš„é…ç½®ä¹‹æœ¯ï¼Œä¼˜åŒ–æˆ‘ä»¬çš„é˜²å¾¡ç³»ç»Ÿï¼"
                """,
                kubernetes_concepts=["ConfigMap", "Secret", "é…ç½®ç®¡ç†", "ç¯å¢ƒå˜é‡"],
                commands_to_learn=["kubectl create configmap", "kubectl create secret", "kubectl get configmaps", "kubectl get secrets", "kubectl describe configmap"],
                challenge_id="chapter_3_challenge",
                reward_exp=400,
                characters=[self.characters["æŒé—¨çœŸäºº"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç¬¬å››ç« : StoryChapter(
                chapter_id=Chapter.ç¬¬å››ç« ,
                title="å­˜å‚¨ä¹‹é“",
                introduction="æ•°æ®ä¹ƒé‡ä¸­ä¹‹é‡ï¼Œä½ éœ€è¦æŒæ¡æ•°æ®æŒä¹…åŒ–ä¹‹æœ¯ã€‚",
                narrative="""
                è¿™ä¸€æ—¥ï¼Œä½ å‘ç°ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼šå®¹å™¨é‡å¯åï¼Œä¹‹å‰å­˜å‚¨çš„é‡è¦æ•°æ®è¡ç„¶æ— å­˜ã€‚
                ä½ æ€¥å¿™å‰å¾€è—ç»é˜ï¼Œå‘ä¸‰å¸ˆå§æ—é›¨è±è¯·æ•™ã€‚
                
                ä¸‰å¸ˆå§å¸¦ä½ æ¥åˆ°è—ç»é˜çš„æ·±å¤„ï¼ŒæŒ‡ç€ä¸€æ’æ’å¤è€çš„ä¹¦æ¶è¯´ï¼š
                "è¿™ä¾¿æ˜¯'PersistentVolume'ä¹‹æœ¯ï¼Œæ•°æ®å¦‚åŒå®—é—¨å…¸ç±ï¼Œéœ€æ°¸ä¹…ä¿å­˜ï¼Œä¸å¯æˆ–ç¼ºã€‚
                å®¹å™¨å°±åƒæ˜¯ä¸´æ—¶çš„ä¿®ç‚¼åœºæ‰€ï¼Œè€ŒPersistentVolumeåˆ™æ˜¯æ°¸ä¹…çš„è—ç»é˜ã€‚"
                
                ä¸‰å¸ˆå§æŠ½å‡ºä¸€æœ¬å¤è€çš„å…¸ç±ï¼Œä¸Šé¢è®°è½½ç€å­˜å‚¨ä¹‹æœ¯ï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    æŒä¹…å­˜å‚¨å¿ƒæ³•                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl get pv                                         â”‚
                â”‚  ï¼ˆæŸ¥çœ‹æ°¸ä¹…å·çš„çŠ¶æ€ï¼‰                                    â”‚
                â”‚                                                         â”‚
                â”‚  kubectl get pvc                                        â”‚
                â”‚  ï¼ˆæŸ¥çœ‹æ°¸ä¹…å·å£°æ˜ï¼‰                                      â”‚
                â”‚                                                         â”‚
                â”‚  kubectl apply -f pvc.yaml                              â”‚
                â”‚  ï¼ˆç”³è¯·å­˜å‚¨ç©ºé—´ï¼Œå¦‚ç”³è¯·æ´åºœä¸€èˆ¬ï¼‰                         â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "PVæ˜¯å®—é—¨æä¾›çš„å­˜å‚¨èµ„æºï¼Œå¦‚åŒè—ç»é˜çš„ä¹¦æ¶ï¼›
                PVCæ˜¯å¼Ÿå­å¯¹å­˜å‚¨çš„ç”³è¯·ï¼Œå¦‚åŒä½ å‘å®—é—¨ç”³è¯·çš„ç§äººä¹¦æ¶ã€‚
                æœ‰äº†æ­¤æœ¯ï¼Œä½ çš„åº”ç”¨ä¾¿æ‹¥æœ‰äº†'è®°å¿†'ï¼Œä¸å†æ‹…å¿ƒæ•°æ®ä¸¢å¤±ã€‚"
                """,
                kubernetes_concepts=["PersistentVolume", "PersistentVolumeClaim", "å­˜å‚¨ç±»", "æ•°æ®æŒä¹…åŒ–"],
                commands_to_learn=["kubectl get pv", "kubectl get pvc", "kubectl apply", "kubectl delete pvc", "kubectl get storageclasses"],
                challenge_id="chapter_4_challenge",
                reward_exp=450,
                characters=[self.characters["ä¸‰å¸ˆå§"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç¬¬äº”ç« : StoryChapter(
                chapter_id=Chapter.ç¬¬äº”ç« ,
                title="è°ƒåº¦ä¹‹å­¦",
                introduction="æˆä¸ºçœŸæ­£çš„å°†å¸…ï¼Œä½ éœ€è¦æŒæ¡èµ„æºè°ƒåº¦ä¸åˆ†é…ä¹‹æœ¯ã€‚",
                narrative="""
                éšç€ä¿®ä¸ºæå‡ï¼Œä½ è¢«ä»»å‘½ä¸ºä¸€æ–¹å°ç»Ÿé¢†ï¼Œè´Ÿè´£ç®¡ç†å®—é—¨çš„éƒ¨åˆ†èµ„æºã€‚
                å¦‚ä½•åˆç†åˆ†é…èµ„æºï¼Œæˆä¸ºä½ é¢ä¸´çš„æ–°æŒ‘æˆ˜ã€‚
                
                è¿™ä¸€æ—¥ï¼Œå®—é—¨çš„å†›å¸ˆå‰æ¥æŒ‡å¯¼ä½ ï¼š
                "å°ç»Ÿé¢†ï¼Œè¦æˆä¸ºä¸€åä¼˜ç§€çš„å°†å¸…ï¼Œä¸ä»…è¦èƒ½æŒ‡æŒ¥å†›é˜Ÿï¼Œ
                æ›´è¦æ‡‚å¾—å¦‚ä½•åˆç†åˆ†é…èµ„æºã€‚æˆ‘æ¥ä¼ æˆä½ 'èµ„æºè°ƒåº¦'ä¹‹æœ¯ã€‚"
                
                å†›å¸ˆå–å‡ºä¸€å¼ åœ°å›¾ï¼Œä¸Šé¢æ ‡è®°ç€å®—é—¨çš„å„ç§èµ„æºï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    èµ„æºè°ƒåº¦å¿ƒæ³•                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl top pods                                       â”‚
                â”‚  ï¼ˆæŸ¥çœ‹å„å¼Ÿå­çš„çµåŠ›æ¶ˆè€—ï¼‰                                â”‚
                â”‚                                                         â”‚
                â”‚  kubectl describe node master                           â”‚
                â”‚  ï¼ˆæŸ¥çœ‹èŠ‚ç‚¹èµ„æºï¼Œå¦‚æŸ¥çœ‹çµå±±çµè„‰ï¼‰                        â”‚
                â”‚                                                         â”‚
                â”‚  kubectl label node worker-1 node-role.kubernetes.io/   â”‚
                â”‚  worker=                                               â”‚
                â”‚  ï¼ˆæ ‡è®°èŠ‚ç‚¹ï¼Œå¦‚åˆ’åˆ†ä¿®ç‚¼åŒºåŸŸï¼‰                            â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "å–„ç”¨æ­¤æœ¯ï¼Œå¯ä½¿å®—é—¨èµ„æºå¾—åˆ°æœ€ä¼˜åˆ†é…ï¼Œ
                è®©æ¯ä½å¼Ÿå­éƒ½èƒ½å„å¸å…¶èŒï¼Œå‘æŒ¥æœ€å¤§æ½œåŠ›ã€‚
                ç°åœ¨ï¼Œç”¨ä½ å­¦åˆ°çš„è°ƒåº¦ä¹‹æœ¯ï¼Œä¼˜åŒ–å®—é—¨çš„èµ„æºåˆ†é…ï¼"
                """,
                kubernetes_concepts=["èµ„æºç®¡ç†", "èŠ‚ç‚¹è°ƒåº¦", "Labels", "Taintså’ŒTolerations"],
                commands_to_learn=["kubectl top", "kubectl describe node", "kubectl label node", "kubectl get nodes", "kubectl cordon node", "kubectl uncordon node"],
                challenge_id="chapter_5_challenge",
                reward_exp=500,
                characters=[self.characters["ç¥ç§˜äºº"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç¬¬å…­ç« : StoryChapter(
                chapter_id=Chapter.ç¬¬å…­ç« ,
                title="æ•…éšœæ’æŸ¥",
                introduction="åœ¨å±æœºä¸­æ•‘ç«ï¼Œæ˜¯æ¯ä¸ªå¼ºè€…å¿…å¤‡çš„æŠ€èƒ½ã€‚",
                narrative="""
                è¿™ä¸€æ—¥ï¼Œå®—é—¨çªç„¶é™·å…¥æ··ä¹±ï¼š"æŠ¥â€”â€”ï¼æ ¸å¿ƒæœåŠ¡å…¨éƒ¨ç˜«ç—ªï¼
                é­”æ•™æ­£åœ¨è¶æœºè¿›æ”»ï¼"
                
                ä½ ä¸´å±å—å‘½ï¼Œè´Ÿè´£æ’æŸ¥æ•…éšœã€‚è¿™æ˜¯ä¸€æ¬¡è€ƒéªŒï¼Œä¹Ÿæ˜¯æˆé•¿çš„æœºä¼šã€‚
                æŒé—¨çœŸäººè¿œç¨‹ä¼ å£°æŒ‡å¯¼ï¼š
                
                "å¾’å„¿ï¼Œç°åœ¨æ˜¯è€ƒéªŒä½ çš„æ—¶å€™äº†ã€‚è®°ä½ï¼Œæ’æŸ¥æ•…éšœå¦‚åŒå¯»åŒ»é—®è¯Šï¼Œ
                éœ€æœ›é—»é—®åˆ‡ï¼Œå¾ªåºæ¸è¿›ã€‚å…ˆçœ‹æ—¥å¿—ï¼Œå†çœ‹äº‹ä»¶ï¼Œæœ€åäº²è‡ªæ¢æŸ¥ã€‚"
                
                æŒé—¨çœŸäººçš„å£°éŸ³åˆšè½ï¼Œä½ çš„è„‘æµ·ä¸­ä¾¿æµ®ç°å‡ºæ•…éšœæ’æŸ¥çš„å¿ƒæ³•ï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    æ•…éšœæ’æŸ¥å¿ƒæ³•                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl logs deployment/web --tail=100                 â”‚
                â”‚  ï¼ˆæŸ¥çœ‹æœ€è¿‘çš„æˆ˜æ–—è®°å½•ï¼‰                                  â”‚
                â”‚                                                         â”‚
                â”‚  kubectl exec -it <pod-name> -- /bin/sh                â”‚
                â”‚  ï¼ˆè¿›å…¥å®¹å™¨å†…éƒ¨ï¼Œå¦‚äº²ä¸´æˆ˜åœºï¼‰                            â”‚
                â”‚                                                         â”‚
                â”‚  kubectl port-forward svc/web 8080:80                  â”‚
                â”‚  ï¼ˆå»ºç«‹ç§˜å¯†é€šé“ï¼Œè¿œç¨‹è¯Šæ–­ï¼‰                              â”‚
                â”‚                                                         â”‚
                â”‚  kubectl events --sort-by='.lastTimestamp'             â”‚
                â”‚  ï¼ˆæŸ¥çœ‹æœ€è¿‘çš„å¤©æœºå˜åŒ–ï¼‰                                  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "å»å§ï¼Œç”¨ä½ å­¦åˆ°çš„æ•…éšœæ’æŸ¥ä¹‹æœ¯ï¼Œæ‹¯æ•‘å®—é—¨äºå±éš¾ä¹‹ä¸­ï¼"
                """,
                kubernetes_concepts=["æ—¥å¿—æŸ¥çœ‹", "Podè°ƒè¯•", "ç«¯å£è½¬å‘", "äº‹ä»¶ç›‘æ§"],
                commands_to_learn=["kubectl logs", "kubectl exec", "kubectl port-forward", "kubectl events", "kubectl debug"],
                challenge_id="chapter_6_challenge",
                reward_exp=550,
                characters=[self.characters["æŒé—¨çœŸäºº"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç¬¬ä¸ƒç« : StoryChapter(
                chapter_id=Chapter.ç¬¬ä¸ƒç« ,
                title="è¿›é˜¶æ“ä½œ",
                introduction="ä½ å·²ç»æŒæ¡åŸºç¡€ï¼Œæ˜¯æ—¶å€™å­¦ä¹ æ›´é«˜æ·±çš„å­¦é—®ã€‚",
                narrative="""
                é­”æ•™æ•™ä¸»è¡€é­”äº²è‡ªæ¥è¢­ï¼Œå®—é—¨é™·å…¥å‰æ‰€æœªæœ‰çš„å±æœºã€‚
                æŒé—¨çœŸäººå°†ä½ å«åˆ°è·Ÿå‰ï¼š
                "å¾’å„¿ï¼Œç°åœ¨æ˜¯ç”Ÿæ­»å­˜äº¡ä¹‹é™…ã€‚æˆ‘å°†ä¼ æˆä½ æœ€åçš„è¿›é˜¶ç§˜æœ¯ï¼Œ
                å¸Œæœ›ä½ èƒ½å‡­å€Ÿæ­¤æœ¯ï¼Œæ‹¯æ•‘å®—é—¨ã€‚"
                
                æŒé—¨çœŸäººåŒæ‰‹ç»“å°ï¼Œç©ºä¸­å‡ºç°äº†è¿›é˜¶ç§˜æœ¯çš„å¿ƒæ³•ï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    è¿›é˜¶ç§˜æœ¯                             â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl apply -f deployment.yaml                       â”‚
                â”‚  ï¼ˆä»¥ä¸å˜åº”ä¸‡å˜ï¼Œæ‰¹é‡æ“ä½œï¼‰                              â”‚
                â”‚                                                         â”‚
                â”‚  kubectl patch deployment web -p \                      â”‚
                â”‚      '{\"spec\":{\"replicas\":5}}'                          â”‚
                â”‚  ï¼ˆä»¥å·§ç ´åŠ›ï¼Œå±€éƒ¨æ›´æ–°ï¼‰                                  â”‚
                â”‚                                                         â”‚
                â”‚  kubectl set image deployment/web \                    â”‚
                â”‚      nginx=nginx:1.21                                   â”‚
                â”‚  ï¼ˆæ”¹å¤©æ¢æ—¥ï¼Œæ›´æ–°é•œåƒï¼‰                                  â”‚
                â”‚                                                         â”‚
                â”‚  kubectl rollout undo deployment/web                    â”‚
                â”‚  ï¼ˆæ—¶å…‰å€’æµï¼Œå›æ»šç‰ˆæœ¬ï¼‰                                  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "æ­¤ä¹ƒYAMLä¹‹é“ï¼Œå¯æ‰¹é‡ã€å¯æ›´æ–°ã€å¯å›æ»šã€‚
                æŒæ¡æ­¤æœ¯ï¼Œä½ ä¾¿å¯ä»¥ä¸€æ•Œä¸‡ï¼Œä»¥ä¸€å½“åï¼
                ç°åœ¨ï¼Œç”¨ä½ å­¦åˆ°çš„è¿›é˜¶ä¹‹æœ¯ï¼Œå¯¹æŠ—è¡€é­”ï¼"
                """,
                kubernetes_concepts=["YAMLé…ç½®", "æ‰¹é‡æ“ä½œ", "è¡¥ä¸æ›´æ–°", "ç‰ˆæœ¬å›æ»š"],
                commands_to_learn=["kubectl apply", "kubectl patch", "kubectl set image", "kubectl rollout undo", "kubectl rollout history"],
                challenge_id="chapter_7_challenge",
                reward_exp=600,
                characters=[self.characters["æŒé—¨çœŸäºº"], self.characters["é­”æ•™æ•™ä¸»"]],
                events=[],
                boss_fight=True
            ),
            
            Chapter.ç¬¬å…«ç« : StoryChapter(
                chapter_id=Chapter.ç¬¬å…«ç« ,
                title="ç½‘ç»œä¸å®‰å…¨",
                introduction="åœ¨ä¿®çœŸç•Œï¼Œç½‘ç»œä¸å®‰å…¨æ˜¯å®ˆæŠ¤å®—é—¨çš„æœ€åé˜²çº¿ã€‚",
                narrative="""
                è¡€é­”è¢«ä½ å‡»è´¥ï¼Œä½†å®—é—¨çš„é˜²å¾¡ä½“ç³»ä¹Ÿå—åˆ°äº†é‡åˆ›ã€‚
                å¤§å¸ˆå…„æé’å³°æ‰¾åˆ°ä½ ï¼š
                "å°å¸ˆå¼Ÿï¼Œè¿™æ¬¡å±æœºè®©æˆ‘ä»¬æ„è¯†åˆ°ï¼Œå®—é—¨çš„ç½‘ç»œä¸å®‰å…¨ä½“ç³»è¿˜ä¸å¤Ÿå®Œå–„ã€‚
                æˆ‘æ¥ä¼ æˆä½ 'ç½‘ç»œä¸å®‰å…¨'ä¹‹æœ¯ï¼Œè¿™æ˜¯å®ˆæŠ¤å®—é—¨çš„æœ€åé˜²çº¿ã€‚"
                
                å¤§å¸ˆå…„å–å‡ºä¸€é¢ç›¾ç‰Œå’Œä¸€æŠŠå‰‘ï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    ç½‘ç»œå®‰å…¨å¿ƒæ³•                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl get networkpolicies                            â”‚
                â”‚  ï¼ˆæŸ¥çœ‹ç½‘ç»œç­–ç•¥ï¼Œå¦‚æŸ¥çœ‹å®—é—¨çš„é˜²å¾¡é˜µæ³•ï¼‰                  â”‚
                â”‚                                                         â”‚
                â”‚  kubectl get roles                                      â”‚
                â”‚  ï¼ˆæŸ¥çœ‹è§’è‰²æƒé™ï¼Œå¦‚æŸ¥çœ‹å®—é—¨å¼Ÿå­çš„èº«ä»½ä»¤ç‰Œï¼‰              â”‚
                â”‚                                                         â”‚
                â”‚  kubectl auth can-i create pods                         â”‚
                â”‚  ï¼ˆéªŒè¯æƒé™ï¼Œå¦‚ç¡®è®¤å¼Ÿå­èµ„æ ¼ï¼‰                            â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "ç½‘ç»œç­–ç•¥å¦‚åŒå®—é—¨çš„é˜²å¾¡é˜µæ³•ï¼Œä¿æŠ¤å†…éƒ¨ç½‘ç»œä¸å—å¤–æ•Œå…¥ä¾µï¼›
                æƒé™ç®¡ç†å¦‚åŒå®—é—¨çš„èº«ä»½ä»¤ç‰Œï¼Œç¡®ä¿åªæœ‰æˆæƒå¼Ÿå­æ‰èƒ½è®¿é—®æ•æ„Ÿèµ„æºã€‚
                å–„ç”¨æ­¤æœ¯ï¼Œå¯ä½¿å®—é—¨å›ºè‹¥é‡‘æ±¤ï¼Œä¸‡æ— ä¸€å¤±ã€‚"
                """,
                kubernetes_concepts=["ç½‘ç»œç­–ç•¥", "RBACæƒé™", "Secretç®¡ç†", "å®‰å…¨æœ€ä½³å®è·µ"],
                commands_to_learn=["kubectl get networkpolicies", "kubectl get roles", "kubectl get rolebindings", "kubectl auth can-i"],
                challenge_id="chapter_8_challenge",
                reward_exp=650,
                characters=[self.characters["å¤§å¸ˆå…„"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç¬¬ä¹ç« : StoryChapter(
                chapter_id=Chapter.ç¬¬ä¹ç« ,
                title="é›†ç¾¤ç®¡ç†",
                introduction="æŒæ¡é›†ç¾¤ç®¡ç†ä¹‹æœ¯ï¼Œæˆä¸ºçœŸæ­£çš„å®—é—¨é¢†è¢–ã€‚",
                narrative="""
                ç»è¿‡ä¸€ç³»åˆ—çš„æˆ˜æ–—å’Œä¿®ç‚¼ï¼Œä½ å·²ç»æˆé•¿ä¸ºå®—é—¨çš„æ ¸å¿ƒå¼Ÿå­ã€‚
                æŒé—¨çœŸäººå†³å®šä¼ æˆä½ é›†ç¾¤ç®¡ç†ä¹‹æœ¯ï¼Œè®©ä½ æˆä¸ºçœŸæ­£çš„å®—é—¨é¢†è¢–ï¼š
                
                "å¾’å„¿ï¼Œä½ å·²ç»æŒæ¡äº†å„ç§å®¹å™¨åŒ–ä¹‹æœ¯ï¼Œç°åœ¨æ˜¯æ—¶å€™å­¦ä¹ å¦‚ä½•ç®¡ç†æ•´ä¸ªé›†ç¾¤äº†ã€‚
                é›†ç¾¤ç®¡ç†ä¹‹æœ¯æ˜¯ä¿®çœŸç•Œçš„æœ€é«˜å¥¥ç§˜ï¼ŒæŒæ¡æ­¤æœ¯ï¼Œä½ ä¾¿å¯ä»¥ä¿¯ç°æ•´ä¸ªä¿®çœŸç•Œã€‚"
                
                æŒé—¨çœŸäººæ‰‹æŒ‡å‘å¤©ï¼Œæ•´ä¸ªä¿®çœŸç•Œçš„åœ°å›¾æµ®ç°åœ¨ç©ºä¸­ï¼š
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    é›†ç¾¤ç®¡ç†å¿ƒæ³•                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  kubectl cluster-info                                   â”‚
                â”‚  ï¼ˆæŸ¥çœ‹é›†ç¾¤ä¿¡æ¯ï¼Œå¦‚ä¿¯ç°æ•´ä¸ªä¿®çœŸç•Œï¼‰                      â”‚
                â”‚                                                         â”‚
                â”‚  kubectl api-resources                                  â”‚
                â”‚  ï¼ˆæŸ¥çœ‹æ‰€æœ‰APIèµ„æºï¼Œå¦‚é˜…è§ˆè—ç»é˜ï¼‰                       â”‚
                â”‚                                                         â”‚
                â”‚  kubectl config view                                    â”‚
                â”‚  ï¼ˆæŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼Œå¦‚æŸ¥çœ‹å®—é—¨è§„çŸ©ï¼‰                        â”‚
                â”‚                                                         â”‚
                â”‚  kubectl version                                        â”‚
                â”‚  ï¼ˆæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚æŸ¥çœ‹ä¿®ä¸ºå¢ƒç•Œï¼‰                        â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "é›†ç¾¤ç®¡ç†ä¹‹æœ¯æ˜¯è¿æ¥å¤©åœ°çš„æ¡¥æ¢ï¼Œé€šè¿‡å®ƒä½ å¯ä»¥æŒæ§æ•´ä¸ªé›†ç¾¤çš„å‘½è¿ã€‚
                ç°åœ¨ï¼Œç”¨ä½ å­¦åˆ°çš„é›†ç¾¤ç®¡ç†ä¹‹æœ¯ï¼Œå¸¦é¢†å®—é—¨èµ°å‘è¾‰ç…Œï¼"
                """,
                kubernetes_concepts=["é›†ç¾¤ç®¡ç†", "APIèµ„æº", "é…ç½®ç®¡ç†", "ç‰ˆæœ¬æ§åˆ¶"],
                commands_to_learn=["kubectl cluster-info", "kubectl api-resources", "kubectl config view", "kubectl version"],
                challenge_id="chapter_9_challenge",
                reward_exp=700,
                characters=[self.characters["æŒé—¨çœŸäºº"]],
                events=[],
                boss_fight=False
            ),
            
            Chapter.ç»ˆç« : StoryChapter(
                chapter_id=Chapter.ç»ˆç« ,
                title="é£å‡å¤§æˆ",
                introduction="å†ç»ç£¨éš¾ï¼Œä½ ç»ˆäºæ‚Ÿé“é£å‡ï¼Œæˆä¸ºä¸€ä»£å®—å¸ˆã€‚",
                narrative="""
                é­”æ•™æ•™ä¸»è¡€é­”è¢«ä½ å½»åº•å‡»è´¥ï¼Œä½ åå£°å¤§å™ªï¼Œæˆä¸ºä¿®çœŸç•Œæ–°ä¸€ä»£ä¼ å¥‡ã€‚
                å®—é—¨ä¸¾è¡Œäº†ç››å¤§çš„åº†å…¸ï¼Œåº†ç¥ä½ çš„èƒœåˆ©ã€‚
                
                æŒé—¨çœŸäººæ¬£æ…°åœ°çœ‹ç€ä½ ï¼š"å¾’å„¿ï¼Œä½ å·²æŒæ¡å®¹å™¨åŒ–ä¹‹é“çš„ç²¾é«“ï¼Œ
                æˆä¸ºäº†ä¸€ä»£å®—å¸ˆã€‚ä»Šæ—¥æœ¬åº§å®£å¸ƒï¼Œä½ æ­£å¼æˆä¸ºé’äº‘å®—çš„æ–°ä¸€ä»£æŒé—¨ï¼"
                
                ä¼—å¼Ÿå­é½å£°æ¬¢å‘¼ï¼Œä½ ç«™åœ¨äº‘ç«¯ï¼Œä¿¯ç°æ•´ä¸ªä¿®çœŸç•Œï¼Œå¿ƒä¸­ä¸€ç‰‡æ¾„æ˜ã€‚
                
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                    å®—å¸ˆå¿ƒæ³•                             â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚  å®¹å™¨ä¹‹é“ï¼Œåœ¨äºå¹³è¡¡ä¸å’Œè°                               â”‚
                â”‚  é›†ç¾¤ç®¡ç†ï¼Œåœ¨äºç»Ÿç­¹ä¸è°ƒåº¦                               â”‚
                â”‚  ç½‘ç»œå®‰å…¨ï¼Œåœ¨äºé˜²å¾¡ä¸ç›‘æ§                               â”‚
                â”‚  è¿›é˜¶æ“ä½œï¼Œåœ¨äºçµæ´»ä¸å˜é€š                               â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                
                "è®°ä½ï¼ŒæŠ€æœ¯ä¹‹è·¯ï¼Œæ°¸æ— æ­¢å¢ƒã€‚å®¹å™¨ä¹‹é“ï¼Œäº¦æ˜¯äººç”Ÿä¹‹é“â€”â€”
                åœ¨äºå¹³è¡¡ï¼Œåœ¨äºå’Œè°ï¼Œåœ¨äºå°†å¤æ‚ä¹‹äº‹åŒ–äºç®€å•ä¹‹é—´ã€‚
                ç°åœ¨ï¼Œä½ å·²ç»æŒæ¡äº†Kubernetesä¹‹é“çš„ç²¾é«“ï¼Œ
                å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°æ“æ§å„ç§èµ„æºï¼Œåˆ›é€ å±äºä½ çš„ä¼ å¥‡ï¼"
                
                ä½ æŠ¬å¤´æœ›å‘æ›´é«˜çš„å¤©ç©ºï¼Œå¿ƒä¸­å……æ»¡äº†æ— é™çš„å¯èƒ½ã€‚
                å‡¡äººä¹‹èº¯ï¼Œç»ˆå¯é—®é“è‹ç©¹ã€‚
                
                â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
                â•‘           ğŸ‰ æ­å–œä½ å·²é£å‡å¤§æˆï¼ ğŸ‰                      â•‘
                â•‘                                                           â•‘
                â•‘       ä½ å·²æŒæ¡Kubernetesä¹‹é“çš„ç²¾é«“ï¼Œæˆä¸ºä¸€ä»£å®—å¸ˆï¼        â•‘
                â•‘                                                           â•‘
                â•‘       æ„¿ä½ å°†æ­¤é“å‘æ‰¬å…‰å¤§ï¼Œå®ˆæŠ¤ä¸–é—´çš„å’Œå¹³ä¸ç§©åºï¼          â•‘
                â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                """,
                kubernetes_concepts=["Kuberneteså…¨è²Œ", "æœ€ä½³å®è·µ", "æŒç»­å­¦ä¹ "],
                commands_to_learn=["kubectl completion", "kubectl plugin list"],
                challenge_id="final_challenge",
                reward_exp=1000,
                characters=[self.characters["æŒé—¨çœŸäºº"], self.characters["å¤§å¸ˆå…„"], self.characters["äºŒå¸ˆå…„"], self.characters["ä¸‰å¸ˆå§"], self.characters["å››å¸ˆå¦¹"]],
                events=[],
                boss_fight=False
            ),
        }
    
    def get_current_chapter(self) -> StoryChapter:
        """è·å–å½“å‰ç« èŠ‚
        
        Returns:
            StoryChapter: å½“å‰ç« èŠ‚å¯¹è±¡
        """
        return self.chapters[self.current_chapter]
    
    def get_chapter(self, chapter: Chapter) -> Optional[StoryChapter]:
        """è·å–æŒ‡å®šç« èŠ‚
        
        Args:
            chapter: ç« èŠ‚ID
            
        Returns:
            Optional[StoryChapter]: æŒ‡å®šç« èŠ‚å¯¹è±¡ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›None
        """
        return self.chapters.get(chapter)
    
    def advance_chapter(self) -> bool:
        """æ¨è¿›åˆ°ä¸‹ä¸€ç« 
        
        Returns:
            bool: å¦‚æœæˆåŠŸæ¨è¿›åˆ°ä¸‹ä¸€ç« èŠ‚åˆ™è¿”å›Trueï¼Œå¦åˆ™è¿”å›False
        """
        chapter_order = list(Chapter)
        current_index = chapter_order.index(self.current_chapter)
        
        if current_index < len(chapter_order) - 1:
            self.current_chapter = chapter_order[current_index + 1]
            return True
        return False
    
    def get_all_commands(self) -> List[str]:
        """è·å–æ‰€æœ‰å‘½ä»¤
        
        Returns:
            List[str]: æ‰€æœ‰ç« èŠ‚çš„å‘½ä»¤åˆ—è¡¨
        """
        commands = []
        for chapter in self.chapters.values():
            commands.extend(chapter.commands_to_learn)
        return commands
    
    def get_chapter_commands(self, chapter: Chapter) -> List[str]:
        """è·å–æŒ‡å®šç« èŠ‚çš„å‘½ä»¤
        
        Args:
            chapter: ç« èŠ‚ID
            
        Returns:
            List[str]: æŒ‡å®šç« èŠ‚çš„å‘½ä»¤åˆ—è¡¨
        """
        chapter_obj = self.get_chapter(chapter)
        if chapter_obj:
            return chapter_obj.commands_to_learn
        return []
    
    def get_total_chapters(self) -> int:
        """è·å–æ€»ç« èŠ‚æ•°
        
        Returns:
            int: æ€»ç« èŠ‚æ•°
        """
        return len(self.chapters)
    
    def get_completed_chapters(self, player: Player) -> int:
        """è·å–å·²å®Œæˆç« èŠ‚æ•°
        
        Args:
            player: ç©å®¶å¯¹è±¡
            
        Returns:
            int: å·²å®Œæˆç« èŠ‚æ•°
        """
        completed = 0
        chapter_challenge_map = {
            Chapter.åºç« : "prologue_challenge",
            Chapter.ç¬¬ä¸€ç« : "chapter_1_challenge",
            Chapter.ç¬¬äºŒç« : "chapter_2_challenge",
            Chapter.ç¬¬ä¸‰ç« : "chapter_3_challenge",
            Chapter.ç¬¬å››ç« : "chapter_4_challenge",
            Chapter.ç¬¬äº”ç« : "chapter_5_challenge",
            Chapter.ç¬¬å…­ç« : "chapter_6_challenge",
            Chapter.ç¬¬ä¸ƒç« : "chapter_7_challenge",
            Chapter.ç¬¬å…«ç« : "chapter_8_challenge",
            Chapter.ç¬¬ä¹ç« : "chapter_9_challenge",
            Chapter.ç»ˆç« : "final_challenge"
        }
        
        for chapter, challenge_id in chapter_challenge_map.items():
            if challenge_id in player.challenges_completed:
                completed += 1
        return completed
    
    def get_story_progress(self, player: Player) -> Dict[str, Any]:
        """è·å–æ•…äº‹è¿›åº¦
        
        Args:
            player: ç©å®¶å¯¹è±¡
            
        Returns:
            Dict[str, Any]: æ•…äº‹è¿›åº¦å­—å…¸
        """
        return {
            "current_chapter": self.current_chapter.value,
            "current_title": self.get_current_chapter().title,
            "total_chapters": self.get_total_chapters(),
            "completed_chapters": self.get_completed_chapters(player),
            "all_commands": len(self.get_all_commands()),
            "mastered_commands": len(player.kubectl_commands_mastered),
            "current_chapter_commands": len(self.get_current_chapter().commands_to_learn),
            "current_chapter_concepts": self.get_current_chapter().kubernetes_concepts
        }
    
    def get_random_event(self, player_level: int) -> Optional[StoryEvent]:
        """è·å–éšæœºäº‹ä»¶
        
        æ ¹æ®ç©å®¶ç­‰çº§ï¼Œéšæœºè¿”å›ä¸€ä¸ªé€‚åˆçš„äº‹ä»¶ã€‚
        
        Args:
            player_level: ç©å®¶ç­‰çº§
            
        Returns:
            Optional[StoryEvent]: éšæœºäº‹ä»¶å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰é€‚åˆçš„äº‹ä»¶åˆ™è¿”å›None
        """
        available_events = [event for event in self.random_events if event.required_level <= player_level]
        if available_events:
            return random.choice(available_events)
        return None
    
    def get_chapter_characters(self, chapter: Chapter) -> List[Character]:
        """è·å–æŒ‡å®šç« èŠ‚çš„äººç‰©åˆ—è¡¨
        
        Args:
            chapter: ç« èŠ‚ID
            
        Returns:
            List[Character]: ç« èŠ‚äººç‰©åˆ—è¡¨
        """
        chapter_obj = self.get_chapter(chapter)
        if chapter_obj:
            return chapter_obj.characters
        return []
    
    def is_boss_chapter(self, chapter: Chapter) -> bool:
        """æ£€æŸ¥ç« èŠ‚æ˜¯å¦æœ‰bossæˆ˜
        
        Args:
            chapter: ç« èŠ‚ID
            
        Returns:
            bool: å¦‚æœç« èŠ‚æœ‰bossæˆ˜åˆ™è¿”å›Trueï¼Œå¦åˆ™è¿”å›False
        """
        chapter_obj = self.get_chapter(chapter)
        if chapter_obj:
            return chapter_obj.boss_fight
        return False